# ADR-001: Архитектурные решения для MVP AI-тренера

## Status

Accepted

## Context

Разрабатываем MVP Telegram-бота AI-тренера для тренажёрного зала. Основная цель - быстрая проверка идеи с минимальными затратами времени и ресурсов. Принцип разработки: KISS (Keep It Simple, Stupid).

## Decision

### Технологический стек

- **Backend**: Python 3.11+ + aiogram 3.x
- **База данных**: PostgreSQL + Redis (кэш/сессии)
- **LLM**: OpenAI GPT-4o-mini через ProxyAPI
- **Деплой**: Docker + Docker Compose на VPS

**Обоснование**: Простой, проверенный стек без излишней сложности. Python обеспечивает быструю разработку, aiogram - готовое решение для Telegram ботов.

### Архитектура

Монолитная архитектура с тремя слоями:

1. **Handlers** - обработка Telegram команд
2. **Services** - бизнес-логика
3. **Requests** - работа с БД

**Обоснование**: Простая и понятная архитектура, подходящая для небольшой команды и быстрого MVP.

### Модель данных

Четыре основные таблицы:

- Users (профили пользователей)
- Exercises (база упражнений)
- Workouts (тренировки)
- WorkoutExercises (упражнения в тренировке)

**Обоснование**: Минимальная модель, покрывающая все ключевые сценарии без излишней сложности.

### Работа с LLM

- Прямые HTTP запросы к ProxyAPI
- Без дополнительных библиотек типа LangChain
- Простая обработка ошибок с retry
- Fallback на базовые тренировки

**Обоснование**: Минимальная зависимость от внешних библиотек, простота отладки и поддержки.

### Сценарии работы

MVP включает 3 базовых сценария:

1. Регистрация пользователя
2. Получение персональной тренировки (раз в 12 часов)
3. Завершение тренировки

**Обоснование**: Полный пользовательский цикл для проверки гипотезы, но без избыточного функционала.

## Consequences

### Positive

- Быстрая разработка и деплой
- Низкие технические риски
- Простота понимания и поддержки
- Возможность быстро добавлять функции

### Negative

- Монолитная архитектура может стать ограничением при росте
- ProxyAPI добавляет зависимость от третьей стороны
- Простая модель данных может потребовать рефакторинга

### Mitigation

- При росте пользователей можно разделить на микросервисы
- Подготовить fallback механизмы для работы без LLM
- Использовать миграции БД для эволюции модели данных

## Date

2024-10-05

## Author

Development Team

